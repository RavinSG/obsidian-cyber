---
tags:
  - Tool
---
Nmap (Network Mapper) is a open-source tool used for *network discovery and security auditing*. It also assists in the exploration of network hosts and services, providing information about open ports, operating systems, and other details.

Nmap can handle repetitive tasks and answer the following questions:

- Which systems are up?
- What services are running on these systems?

Nmap’s scripting engine can further extend its functionality, from fingerprinting services to exploiting vulnerabilities. A Nmap scan usually goes through the steps shown in the figure below, although many are optional and depend on the command-line arguments you provide.

![[Nmap Functionality.png|400]]

### Discovering Live Hosts

There are different approaches that Nmap uses to discover live hosts. Such as:

- **ARP scan**: This scan uses ARP requests to discover live hosts
- **ICMP scan**: This scan uses ICMP requests to identify live hosts
- **TCP/UDP ping scan**: This scan sends packets to TCP ports and UDP ports to determine live hosts.

Consider the following network:

![[Network Architecture.png|500]]
#### ARP Scan
If you are in Network A, you can use **ARP** only to *discover the devices within that subnet* (`10.1.100.0/24`). Suppose you are connected to a subnet different from the subnet of the target system(s). In that case, all packets generated by your scanner will be routed via the default gateway (router) to reach the systems on another subnet; however, the ARP queries won’t be routed and hence cannot cross the subnet router. **ARP is a link-layer protocol**, and ARP packets are bound to their subnet.


When no host discovery options are provided, Nmap follows the following approaches to discover live hosts:

- When a *privileged user* tries to scan targets on a *local network* (Ethernet), Nmap uses **ARP** requests. A privileged user is root or a user who belongs to `sudoers` and can run `sudo`.

- When a *privileged user* tries to scan targets *outside the local network*, Nmap uses **ICMP echo** requests, **TCP ACK** (Acknowledge) to port 80, **TCP SYN** (Synchronize) to port 443, and **ICMP timestamp** request.

- When an *unprivileged user* tries to scan targets *outside the local network*, Nmap resorts to a **TCP 3-way handshake** by sending SYN packets to ports 80 and 443.

- [[Host Discovery using ARP]]
- [[Host Discovery Using ICMP]]
- [[Host Discovery Using TCP and UDP]]

